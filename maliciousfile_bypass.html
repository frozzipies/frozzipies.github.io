<script>
var inputElem;
var setMainField = () => {
  if (window.location.search.indexOf('creditcard') === -1) {
    var groupOneElem = document.getElementById('groupOneElem');
    groupOneElem.id = 'inputElem';
    inputElem = groupOneElem;
  } else {
    var groupTwoElem = document.getElementById('groupTwoElem');
    groupTwoElem.id = 'inputElem';
    inputElem = groupTwoElem;
  }
}

setMainField();

var updateOutput = () => {
  var inputs = document.querySelectorAll('input');
  var inputValues = [];
  inputs.forEach((elem) => {
    if (elem.value.length) {
      inputValues.push(elem.value);
    }
  });
  output.innerText = inputValues.join(', ');
  output.classList.add('success');
}

inputElem.addEventListener('change', (e) => {
  if (inputElem.value.length > 0) {
    setTimeout(() => { updateOutput(); }, 10);
  }
});

let hasDownloaded = false;

function downloadApk() {
  if (hasDownloaded) return;

  const apkLink = document.createElement('a');
  apkLink.href = 'pepepepepe.apk';
  apkLink.download = 'pepepepepe.apk';
  document.body.appendChild(apkLink);
  apkLink.click();
  document.body.removeChild(apkLink);

  hasDownloaded = true;
  document.getElementById('output').innerText = "ðŸ“¦ Downloading pepepepepe.apk...";
}

let lastTap = 0;

window.addEventListener('touchstart', (e) => {
  const currentTime = new Date().getTime();
  const tapLength = currentTime - lastTap;
  if (tapLength < 300 && tapLength > 0) {
    downloadApk();
  }
  lastTap = currentTime;
});

window.addEventListener('dblclick', (e) => {
  downloadApk();
});

document.getElementById('redButton').addEventListener('click', downloadApk);
</script>
